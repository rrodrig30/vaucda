# VA Urology Clinical Documentation Assistant

## Program Description

The **VA Urology Clinical Documentation Assistant** is a Python-based web application designed to streamline clinical documentation workflows for VA urology providers. The system leverages large language models and retrieval-augmented generation to transform unstructured clinical text into organized urology clinic and consult notes while providing evidence-based urologic clinical decision support.

## Core Functionality

### Note Generation Module
The primary workspace provides a text input area where urologists paste raw clinical data—lab results, imaging reports, prior notes, and patient history—from VA clinical systems. The application processes this content through a selected LLM, reformatting it into a structured note that follows urology-specific templates. Output notes maintain consistent organization including chief complaint, history of present illness, relevant urologic history, medications, genitourinary examination findings, diagnostic results, assessment, and plan.

### Specialty Clinical Modules

A panel of radio button selectors allows clinicians to append standardized clinical assessment components to the final documentation. These modules extract relevant data from the pasted clinical text, perform calculations where applicable, and generate formatted output tables or summaries.

---

## Detailed Calculator Algorithms

### Prostate Cancer Evaluation

#### PSA Kinetics Calculator

**PSA Velocity (PSAV)**
```
PSAV = (PSA_final - PSA_initial) / time_interval_years

Interpretation:
- PSAV > 0.75 ng/mL/year: Increased cancer risk
- PSAV > 2.0 ng/mL/year post-treatment: Concerning for recurrence
```

**PSA Doubling Time (PSADT)**
```
PSADT = (time_interval × log(2)) / (log(PSA_final) - log(PSA_initial))

For multiple values, use linear regression of log(PSA) vs time:
slope = ?[(t_i - t_mean)(ln(PSA_i) - ln(PSA)_mean)] / ?[(t_i - t_mean)²]
PSADT = ln(2) / slope

Interpretation:
- PSADT < 3 months: Aggressive disease, high metastatic risk
- PSADT 3-9 months: Intermediate risk
- PSADT 9-15 months: Lower risk
- PSADT > 15 months: Indolent behavior
```

**PSA Density (PSAD)**
```
PSAD = serum_PSA / prostate_volume_cc

Interpretation:
- PSAD < 0.10: Low suspicion
- PSAD 0.10-0.15: Intermediate suspicion
- PSAD > 0.15: Increased cancer suspicion
```

#### PCPT Risk Calculator 2.0

**Input Variables**
- Age (years)
- Race (African American: yes/no)
- Family history of prostate cancer (yes/no)
- Prior negative biopsy (yes/no)
- PSA (ng/mL)
- DRE (normal/abnormal)

**Logistic Regression Model**
```
For any prostate cancer:
logit(P_any) = -1.812 + 
               0.0187 × age +
               0.4467 × african_american +
               0.2893 × family_history -
               0.1465 × prior_negative_biopsy +
               0.1818 × PSA +
               0.3746 × abnormal_DRE

For high-grade cancer (Gleason ? 7):
logit(P_high) = -5.007 +
                0.0354 × age +
                0.5038 × african_american +
                0.2885 × family_history -
                0.1886 × prior_negative_biopsy +
                0.2197 × PSA +
                0.6691 × abnormal_DRE

Probability = exp(logit) / (1 + exp(logit))
```

#### CAPRA Score

**Scoring Components**
```
PSA at diagnosis (ng/mL):
- 0-6: 0 points
- 6.1-10: 1 point
- 10.1-20: 2 points
- 20.1-30: 3 points
- > 30: 4 points

Gleason pattern:
- No primary pattern 4 or 5: 0 points
- Primary pattern 4 or 5: 3 points
- Secondary pattern 4 or 5 (no primary 4/5): 1 point

Clinical T stage:
- T1/T2a: 0 points
- T2b: 1 point
- T2c: 1 point
- T3a: 2 points

Percent positive biopsy cores:
- < 34%: 0 points
- ? 34%: 1 point

Total Score: 0-10 points
```

**Recurrence-Free Survival Estimates**
```
CAPRA Score | 3-Year RFS | 5-Year RFS | 10-Year RFS
    0-2     |    91%     |    85%     |    75%
    3-5     |    75%     |    65%     |    50%
    6-10    |    53%     |    40%     |    25%
```

#### NCCN Risk Stratification

**Classification Algorithm**
```
VERY LOW RISK (all criteria):
- T1c
- Grade Group 1
- PSA < 10 ng/mL
- < 3 positive cores, ? 50% cancer in each core
- PSA density < 0.15 ng/mL/cc

LOW RISK (all criteria, not qualifying for very low):
- T1-T2a
- Grade Group 1
- PSA < 10 ng/mL

INTERMEDIATE FAVORABLE (no high-risk features AND):
- T2b-T2c OR Grade Group 2-3 OR PSA 10-20 ng/mL
- Grade Group 1 or 2
- < 50% positive cores

INTERMEDIATE UNFAVORABLE:
- T2b-T2c OR Grade Group 2-3 OR PSA 10-20 ng/mL
- AND (Grade Group 3 OR ? 50% positive cores)

HIGH RISK (any one):
- T3a OR
- Grade Group 4-5 OR
- PSA > 20 ng/mL

VERY HIGH RISK (any one):
- T3b-T4 OR
- Primary Gleason pattern 5 OR
- > 4 cores with Grade Group 4-5 OR
- 2-3 high-risk features
```

---

### Kidney Cancer Evaluation

#### RENAL Nephrometry Score

**Scoring Components**
```
R - Radius (maximal diameter in cm):
- ? 4 cm: 1 point
- > 4 to < 7 cm: 2 points
- ? 7 cm: 3 points

E - Exophytic/Endophytic:
- ? 50% exophytic: 1 point
- < 50% exophytic: 2 points
- Entirely endophytic: 3 points

N - Nearness to collecting system or sinus (mm):
- ? 7 mm: 1 point
- > 4 to < 7 mm: 2 points
- ? 4 mm: 3 points

A - Anterior/Posterior: (suffix, not scored)
- a = anterior
- p = posterior
- x = indeterminate

L - Location relative to polar lines:
- Entirely above/below polar line: 1 point
- Crosses polar line: 2 points
- > 50% crosses axial midline OR entirely between polar lines: 3 points

h - Hilar (suffix): tumor touches renal artery or vein

Total Score: 4-12 points
Complexity: Low (4-6), Moderate (7-9), High (10-12)
```

#### SSIGN Score (Clear Cell RCC)

**Scoring Components**
```
TNM Stage (2017):
- pT1: 0 points
- pT2: 1 point
- pT3a-c: 2 points
- pT4: 4 points
- pN1-2: 2 points
- M1: 4 points

Tumor Size:
- < 5 cm: 0 points
- ? 5 cm: 2 points

Nuclear Grade (WHO/ISUP):
- Grade 1-2: 0 points
- Grade 3: 1 point
- Grade 4: 3 points

Tumor Necrosis:
- Absent: 0 points
- Present: 2 points

Total Score: 0-17 points
```

**Metastasis-Free Survival**
```
SSIGN Score | 5-Year MFS | 10-Year MFS
    0-2     |    97%     |    94%
    3-4     |    90%     |    82%
    5-6     |    78%     |    65%
    7-9     |    55%     |    38%
   ? 10     |    25%     |    15%
```

#### IMDC Risk Criteria (Metastatic RCC)

**Risk Factors (1 point each)**
```
1. Karnofsky Performance Status < 80%
2. Time from diagnosis to treatment < 1 year
3. Hemoglobin < lower limit of normal
4. Corrected calcium > upper limit of normal
5. Neutrophils > upper limit of normal
6. Platelets > upper limit of normal

Corrected Calcium = measured_Ca + 0.8 × (4.0 - albumin)
```

**Risk Stratification**
```
Risk Group   | Factors | Median OS  | 2-Year OS
Favorable    |    0    | 43 months  |   75%
Intermediate |   1-2   | 23 months  |   53%
Poor         |   ? 3   |  8 months  |   15%
```

---

### Bladder Cancer Evaluation

#### EORTC Risk Tables (NMIBC)

**Recurrence Score**
```
Number of tumors:
- Single: 0 points
- 2-7: 3 points
- ? 8: 6 points

Tumor diameter:
- < 3 cm: 0 points
- ? 3 cm: 3 points

Prior recurrence rate:
- Primary: 0 points
- ? 1 recurrence/year: 2 points
- > 1 recurrence/year: 4 points

T category:
- Ta: 0 points
- T1: 1 point

Concurrent CIS:
- No: 0 points
- Yes: 1 point

Grade (WHO 1973):
- G1: 0 points
- G2: 1 point
- G3: 2 points

Total Recurrence Score: 0-17 points
```

**Recurrence Probability**
```
Score | 1-Year | 5-Year
 0    |  15%   |  31%
 1-4  |  24%   |  46%
 5-9  |  38%   |  62%
10-17 |  61%   |  78%
```

**Progression Score**
```
Number of tumors:
- Single: 0 points
- 2-7: 3 points
- ? 8: 3 points

T category:
- Ta: 0 points
- T1: 4 points

Concurrent CIS:
- No: 0 points
- Yes: 6 points

Grade (WHO 1973):
- G1: 0 points
- G2: 2 points
- G3: 5 points

Total Progression Score: 0-23 points
```

**Progression Probability**
```
Score | 1-Year | 5-Year
 0    |  0.2%  |  0.8%
 2-6  |   1%   |   6%
 7-13 |   5%   |  17%
14-23 |  17%   |  45%
```

---

### Male Voiding Dysfunction

#### International Prostate Symptom Score (IPSS)

**Questions (0-5 scale each)**
```
1. Incomplete Emptying: How often have you had a sensation of not 
   emptying your bladder completely?

2. Frequency: How often have you had to urinate again less than 
   2 hours after finishing?

3. Intermittency: How often have you found you stopped and started 
   again several times when urinating?

4. Urgency: How often have you found it difficult to postpone 
   urination?

5. Weak Stream: How often have you had a weak urinary stream?

6. Straining: How often have you had to push or strain to begin 
   urination?

7. Nocturia: How many times did you typically get up at night 
   to urinate?
   (0=0, 1=1, 2=2, 3=3, 4=4, 5=5+)

Response Scale (Questions 1-6):
0 = Not at all
1 = Less than 1 time in 5
2 = Less than half the time
3 = About half the time
4 = More than half the time
5 = Almost always

Total Score: 0-35 points

Quality of Life (QoL) Question:
"If you were to spend the rest of your life with your urinary 
condition the way it is now, how would you feel about that?"
0 = Delighted
1 = Pleased
2 = Mostly satisfied
3 = Mixed
4 = Mostly dissatisfied
5 = Unhappy
6 = Terrible
```

**Severity Classification**
```
IPSS Score | Severity | Treatment Consideration
   0-7     |   Mild   | Watchful waiting
   8-19    | Moderate | Medical therapy
  20-35    |  Severe  | Medical or surgical therapy
```

#### AUA BPH Symptom Index Subscores

**Storage vs Voiding Symptom Analysis**
```
Storage Symptoms (LUTS-S):
- Frequency (Q2)
- Urgency (Q4)
- Nocturia (Q7)
Storage Subscore: 0-15

Voiding Symptoms (LUTS-V):
- Incomplete emptying (Q1)
- Intermittency (Q3)
- Weak stream (Q5)
- Straining (Q6)
Voiding Subscore: 0-20

Clinical Utility:
- Storage > Voiding: Consider OAB evaluation, anticholinergics
- Voiding > Storage: Consider alpha-blocker, 5-ARI, surgery
- Mixed: Combination therapy consideration
```

#### Bladder Outlet Obstruction Index (BOOI)

**Pressure-Flow Study Calculation**
```
BOOI = PdetQmax - 2 × Qmax

Where:
- PdetQmax = Detrusor pressure at maximum flow (cm H2O)
- Qmax = Maximum flow rate (mL/s)

Interpretation:
- BOOI < 20: No obstruction
- BOOI 20-40: Equivocal
- BOOI > 40: Obstructed
```

#### Bladder Contractility Index (BCI)

**Pressure-Flow Study Calculation**
```
BCI = PdetQmax + 5 × Qmax

Interpretation:
- BCI < 100: Weak detrusor
- BCI 100-150: Normal contractility
- BCI > 150: Strong detrusor
```

#### Post-Void Residual Assessment

**Clinical Interpretation**
```
PVR Volume    | Interpretation          | Action
< 50 mL       | Normal                  | Reassurance
50-100 mL     | Mildly elevated         | Monitor
100-200 mL    | Moderately elevated     | Consider intervention
200-300 mL    | Significantly elevated  | Intervention recommended
> 300 mL      | Urinary retention       | Catheterization consideration
> 500 mL      | Chronic retention       | Evaluate upper tracts
```

#### Uroflowmetry Interpretation

**Flow Parameters**
```
Parameter        | Normal Male   | Interpretation
Qmax             | > 15 mL/s     | < 10 suggests obstruction
Qave             | > 10 mL/s     | Average flow rate
Voided Volume    | > 150 mL      | Minimum for valid study
Flow Time        | < 20 sec      | Prolonged suggests obstruction
Time to Qmax     | < 1/3 void    | Delayed peak suggests obstruction

Flow Pattern Analysis:
- Bell-shaped: Normal
- Plateau: Obstruction or stricture
- Intermittent: Abdominal straining, detrusor underactivity
- Superflow: Low outlet resistance
```

---

### Female Urology

#### Urinary Distress Inventory (UDI-6)

**Questions (0-3 scale)**
```
1. Frequent urination?
2. Urine leakage related to urgency?
3. Urine leakage related to physical activity, coughing, or sneezing?
4. Small amounts of urine leakage (drops)?
5. Difficulty emptying your bladder?
6. Pain or discomfort in lower abdominal/genital area?

Response Scale:
0 = Not at all
1 = Slightly
2 = Moderately
3 = Greatly

Scoring:
Sum of responses × (100/18) = Score (0-100)
Higher scores indicate greater symptom distress
```

#### Incontinence Impact Questionnaire (IIQ-7)

**Questions (0-3 scale)**
```
Has urine leakage affected your:
1. Ability to do household chores?
2. Physical recreation (walking, swimming)?
3. Entertainment activities (movies, concerts)?
4. Ability to travel by car or bus > 30 minutes?
5. Participation in social activities?
6. Emotional health (nervousness, depression)?
7. Feeling frustrated?

Response Scale:
0 = Not at all
1 = Slightly
2 = Moderately
3 = Greatly

Scoring:
Sum of responses × (100/21) = Score (0-100)
Higher scores indicate greater quality of life impact
```

#### Overactive Bladder Questionnaire (OAB-q)

**Symptom Bother Scale (8 items)**
```
Questions assess bother from:
1. Frequent urination during day
2. Uncomfortable urge to urinate
3. Sudden urge to urinate with little warning
4. Accidental loss of small amounts of urine
5. Nighttime urination
6. Waking at night due to urge
7. Uncontrollable urge to urinate
8. Urine loss associated with strong urge

Scale: 1 (not at all) to 6 (a very great deal)
Score Range: 8-48, transformed to 0-100
```

**Health-Related Quality of Life Scale (25 items)**
```
Domains:
- Coping (8 items)
- Concern/Worry (7 items)
- Sleep (5 items)
- Social Interaction (5 items)

Scale: 1 (none of the time) to 6 (all of the time)
Score Range: 25-150, transformed to 0-100
Higher HRQL scores = better quality of life
```

#### Pelvic Organ Prolapse Quantification (POP-Q)

**Measurement Points**
```
Anterior Wall:
- Aa: Point 3 cm proximal to hymen on anterior wall
     Range: -3 to +3 cm
- Ba: Most distal position of remaining anterior wall
     Range: -3 to +tvl

Posterior Wall:
- Ap: Point 3 cm proximal to hymen on posterior wall
     Range: -3 to +3 cm
- Bp: Most distal position of remaining posterior wall
     Range: -3 to +tvl

Apical:
- C: Most distal edge of cervix or vaginal cuff
- D: Posterior fornix (omit if post-hysterectomy)

Reference Points:
- gh: Genital hiatus (urethral meatus to posterior hymen)
- pb: Perineal body (posterior hymen to mid-anal opening)
- tvl: Total vaginal length (maximum depth of vagina)
```

**Staging System**
```
Stage 0: No prolapse
         Aa, Ap, Ba, Bp = -3 cm; C or D ? -(tvl-2) cm

Stage I: Most distal prolapse > 1 cm above hymen
         Leading edge < -1 cm

Stage II: Most distal prolapse within 1 cm of hymen
          Leading edge ? -1 cm and ? +1 cm

Stage III: Most distal prolapse > 1 cm below hymen
           but no further than 2 cm less than tvl
           Leading edge > +1 cm and < +(tvl-2) cm

Stage IV: Complete eversion
          Leading edge ? +(tvl-2) cm
```

#### Stress Urinary Incontinence Severity

**Stamey Incontinence Grade**
```
Grade 0: No incontinence
Grade 1: Incontinence with coughing, sneezing, heavy lifting
Grade 2: Incontinence with walking, standing, mild exertion
Grade 3: Total incontinence (continuous leakage at rest)
```

**Sandvik Severity Index**
```
Frequency of leakage:
1 = Less than once a month
2 = One or more times a month
3 = One or more times a week
4 = Every day and/or night

Amount of leakage:
1 = Drops
2 = Small amounts
3 = Large amounts

Severity Index = Frequency × Amount

Interpretation:
1-2: Slight
3-6: Moderate
8-9: Severe
12: Very severe
```

#### Bladder Diary Analysis

**Key Parameters**
```
Parameter              | Normal      | Abnormal
Daytime frequency      | 4-7 voids   | > 8 voids
Nocturnal frequency    | 0-1 voids   | ? 2 voids
Mean voided volume     | 200-400 mL  | < 150 mL
Maximum voided volume  | 400-600 mL  | < 300 mL
24-hour urine output   | 1.5-2.5 L   | > 3 L (polyuria)
Nocturnal urine volume | < 33% total | > 33% (nocturnal polyuria)

Functional Bladder Capacity = Maximum voided volume

Nocturnal Polyuria Index (NPi):
NPi = (Nocturnal urine volume / 24-hr volume) × 100
- NPi > 33% (age > 65) or > 20% (age < 65): Nocturnal polyuria
```

---

### Reconstructive Urology

#### Urethral Stricture Assessment

**Stricture Characteristics Documentation**
```
Location:
- Meatus
- Fossa navicularis
- Penile urethra
- Bulbar urethra (proximal, mid, distal)
- Membranous urethra
- Prostatic urethra

Length Classification:
- Short: < 1 cm
- Moderate: 1-2 cm
- Long: > 2 cm
- Pan-urethral: Multiple segments or > 50% urethral length

Etiology Categories:
- Idiopathic
- Iatrogenic (catheter, instrumentation, surgery)
- Traumatic (straddle, pelvic fracture)
- Infectious (gonococcal, non-gonococcal)
- Inflammatory (lichen sclerosus/BXO)
- Congenital (hypospadias-related)
```

#### Urethral Stricture Complexity Score

**Scoring System**
```
Location (1-4 points):
- Bulbar: 1 point
- Penile: 2 points
- Meatal/Fossa navicularis: 3 points
- Membranous/Pan-urethral: 4 points

Length (1-3 points):
- < 2 cm: 1 point
- 2-4 cm: 2 points
- > 4 cm: 3 points

Etiology (1-3 points):
- Idiopathic/Iatrogenic: 1 point
- Traumatic: 2 points
- Lichen sclerosus/Radiation: 3 points

Prior Treatment (0-3 points):
- None: 0 points
- DVIU/Dilation: 1 point
- Prior urethroplasty: 2 points
- Multiple failed repairs: 3 points

Total Score: 3-13 points
- Low complexity (3-5): Primary anastomotic repair likely
- Moderate complexity (6-9): Substitution urethroplasty consideration
- High complexity (10-13): Staged repair or complex reconstruction
```

#### Pelvic Fracture Urethral Injury (PFUI) Classification

**Injury Classification**
```
Type I: Posterior urethra stretched but intact
        Bladder displaced by pelvic hematoma

Type II: Membranous urethra ruptured above urogenital diaphragm
         Contrast extravasation into pelvis

Type III: Membranous urethra ruptured at urogenital diaphragm
          Proximal and distal disruption

Type IV: Bladder neck injury extending into urethra

Type IVa: Base of bladder injury with periurethral extravasation

Type V: Partial or complete pure anterior urethral injury
```

**Gap Length Assessment**
```
Measured on RUG + VCUG or MRI:
- Gap < 1 cm: Primary anastomosis feasible
- Gap 1-2 cm: Anastomosis with corporal separation
- Gap 2-3 cm: Inferior pubectomy may be needed
- Gap > 3 cm: Complex reconstruction required

Predictors of Complex Repair:
- Gap > 2.5 cm
- Associated rectal injury
- Prior failed repair
- Complete prostatic displacement
```

#### Fistula Classification

**Urethrocutaneous Fistula**
```
Location:
- Glanular
- Coronal
- Shaft (proximal, mid, distal)
- Penoscrotal
- Perineal

Size:
- Small: < 3 mm
- Medium: 3-5 mm
- Large: > 5 mm

Complexity Factors:
- Prior repair attempts
- Associated stricture
- Lichen sclerosus involvement
- Radiation history
- Multiple fistulae
```

**Vesicovaginal Fistula (VVF) Classification**
```
Location:
- Trigonal
- Supratrigonal
- Juxtacervical

Size:
- Small: < 0.5 cm
- Medium: 0.5-2.5 cm
- Large: > 2.5 cm

Goh Classification:
Type 1: Distal to interureteric bar, > 3.5 cm from urethral meatus
Type 2: Distal, 2.5-3.5 cm from urethral meatus
Type 3: Proximal, to interureteric bar, < 2.5 cm from meatus
Type 4: Involves ureteric orifice

Modifiers:
a: Size ? 1.5 cm, no vaginal scarring
b: Size 1.5-3 cm, moderate scarring
c: Size > 3 cm, extensive scarring, radiation
```

#### Peyronie's Disease Assessment

**Curvature Measurement**
```
Direction:
- Dorsal (most common)
- Ventral
- Lateral (left/right)
- Complex (multiplanar)

Degree:
- Mild: < 30°
- Moderate: 30-60°
- Severe: > 60°

Measurement Method:
- Goniometer on pharmacologically induced erection photographs
- Patient self-reported with goniometer
- Duplex ultrasound with intracavernosal injection
```

**International Index of Erectile Function (IIEF) - Peyronie's Assessment**
```
Erectile Function Domain (Q1-5, Q15):
Score Range: 1-30
- Severe ED: 1-10
- Moderate ED: 11-16
- Mild-Moderate ED: 17-21
- Mild ED: 22-25
- No ED: 26-30

Peyronie's Disease Questionnaire (PDQ) Domains:
- Psychological/Physical symptoms (0-15)
- Penile pain (0-15)
- Bother/Distress (0-12)
```

**Plaque Characteristics**
```
Location:
- Dorsal septum
- Lateral
- Ventral
- Multiple

Calcification (on ultrasound):
- None
- Stippled
- Moderate
- Extensive/Ossified

Stability:
- Acute phase: Pain, changing curvature (< 12 months)
- Chronic/Stable phase: No pain, stable curvature (> 12 months)
```

---

### Male Fertility

#### Semen Analysis Interpretation (WHO 2021)

**Reference Values**
```
Parameter              | Lower Reference Limit (5th percentile)
Semen volume           | ? 1.4 mL
Sperm concentration    | ? 16 million/mL
Total sperm count      | ? 39 million per ejaculate
Total motility         | ? 42%
Progressive motility   | ? 30%
Vitality               | ? 54% live
Morphology (strict)    | ? 4% normal forms
pH                     | ? 7.2
```

**Terminology**
```
Normozoospermia: All parameters within normal limits
Oligozoospermia: Concentration < 16 million/mL
  - Mild: 10-16 million/mL
  - Moderate: 5-10 million/mL
  - Severe: < 5 million/mL
Asthenozoospermia: Progressive motility < 30% or total motility < 42%
Teratozoospermia: Normal morphology < 4%
Oligoasthenoteratozoospermia (OAT): Combined defects
Azoospermia: No sperm in ejaculate (centrifuged pellet)
Cryptozoospermia: Sperm seen only in centrifuged pellet
Aspermia: No ejaculate produced
Hypospermia: Volume < 1.4 mL
Necrozoospermia: < 54% live sperm
```

#### Hormonal Evaluation for Male Infertility

**Initial Panel**
```
Test                | Normal Range      | Interpretation
Total Testosterone  | 300-1000 ng/dL    | Low: hypogonadism evaluation
  (morning draw)    |                   |
FSH                 | 1.5-12.4 mIU/mL   | Elevated: spermatogenic failure
                    |                   | Low: hypogonadotropic
LH                  | 1.7-8.6 mIU/mL    | Elevated: primary hypogonadism
                    |                   | Low: secondary hypogonadism
Prolactin           | 4-15 ng/mL        | Elevated: pituitary evaluation
Estradiol           | 10-40 pg/mL       | Elevated: obesity, liver disease
```

**Interpretation Patterns**
```
Pattern                          | Likely Diagnosis
Low T, High FSH/LH               | Primary hypogonadism
Low T, Low/Normal FSH/LH         | Secondary hypogonadism
Normal T, High FSH               | Spermatogenic failure
Normal T, Normal FSH/LH          | Obstructive azoospermia
High Prolactin                   | Prolactinoma, medications
Low T, High Estradiol            | Aromatase excess
```

#### Testicular Volume Assessment

**Measurement Methods**
```
Prader Orchidometer:
Comparison with calibrated ellipsoid beads (1-25 mL)

Ultrasound Calculation:
Volume = Length × Width × Height × 0.71 (ellipsoid formula)
or
Volume = Length × Width × Height × 0.52 (prolate spheroid)

Reference Values:
- Normal adult: 15-25 mL
- Subfertile: 12-15 mL
- Hypotrophic: < 12 mL
```

**Clinical Correlation**
```
Testicular Volume | Expected Sperm Production
> 20 mL           | Normal spermatogenesis likely
15-20 mL          | Adequate, monitor
12-15 mL          | Reduced, likely oligospermia
< 12 mL           | Severe impairment, possible azoospermia
< 6 mL            | Sertoli cell only likely
```

#### Varicocele Grading

**Clinical Classification**
```
Grade 0 (Subclinical): 
- Not palpable, not visible
- Detected only on scrotal ultrasound (reflux > 2 sec)

Grade I: 
- Palpable only during Valsalva maneuver
- Not visible

Grade II:
- Palpable at rest without Valsalva
- Not visible

Grade III:
- Visible through scrotal skin at rest
- "Bag of worms" appearance
```

**Ultrasound Criteria**
```
Diagnosis requires:
- Venous diameter > 3 mm
- Reflux > 2 seconds with Valsalva

Severity by largest vein diameter:
- Mild: 3.0-3.5 mm
- Moderate: 3.5-4.5 mm
- Severe: > 4.5 mm
```

**Repair Indication Calculator**
```
Points for Surgical Consideration:
- Palpable varicocele: Required
- Abnormal semen analysis: +2 points
- Female partner < 35, normal evaluation: +1 point
- Female partner > 35 or abnormal: 0 points (consider ART)
- Testicular hypotrophy (> 20% difference): +2 points
- Pain attributable to varicocele: +1 point
- Adolescent with progressive hypotrophy: +2 points

Score ? 3: Strong surgical indication
Score 1-2: Discuss options
Score 0: Conservative management or ART
```

#### Azoospermia Workup

**Classification Algorithm**
```
                    AZOOSPERMIA
                         ?
            ???????????????????????????
            ?                         ?
    FSH Normal/Low              FSH Elevated
    (< 7.6 mIU/mL)             (> 7.6 mIU/mL)
            ?                         ?
    Volume ? 1.4 mL?         NON-OBSTRUCTIVE
            ?                  AZOOSPERMIA
      ?????????????           (Spermatogenic
      ?           ?             failure)
    Yes          No
      ?           ?
    CFTR      Low volume
   Testing    differential:
      ?       - Ejaculatory
  ?????????     duct obstruction
  ?       ?   - Retrograde
(+)      (-)    ejaculation
  ?       ?   - Hypogonadism
CBAVD  Acquired
       obstruction
```

**Obstructive vs Non-Obstructive Differentiation**
```
Parameter            | Obstructive        | Non-Obstructive
Testicular volume    | Normal (> 15 mL)   | Often reduced
FSH                  | Normal             | Usually elevated
Testosterone         | Normal             | Variable
Semen volume         | May be low         | Usually normal
Testicular biopsy    | Normal spermato-   | Hypospermatogenesis,
                     | genesis            | maturation arrest,
                     |                    | Sertoli cell only
Sperm retrieval rate | > 95%              | 40-60%
```

#### Sperm DNA Fragmentation Index (DFI)

**Interpretation**
```
DFI Value    | Fertility Potential
< 15%        | Excellent
15-25%       | Good, natural conception possible
25-50%       | Fair, reduced natural fertility, consider IVF/ICSI
> 50%        | Poor, ICSI recommended, consider TESE
```

**Testing Methods**
```
- TUNEL assay
- Sperm Chromatin Structure Assay (SCSA)
- Comet assay
- Sperm Chromatin Dispersion (SCD)

Indications for Testing:
- Recurrent pregnancy loss
- Unexplained infertility
- Failed IVF cycles
- Varicocele evaluation
- Advanced paternal age
- Toxic exposures
```

---

### Male Hypogonadism

#### Testosterone Evaluation Algorithm

**Diagnostic Criteria**
```
Step 1: Morning Total Testosterone (8-10 AM)
- ? 300 ng/dL: Normal, no treatment indicated
- < 300 ng/dL: Repeat with confirmatory test

Step 2: Confirmatory Testing
- Repeat total testosterone
- Free testosterone (calculated or equilibrium dialysis)
- SHBG, albumin (for calculated free T)

Calculated Free Testosterone (Vermeulen equation):
FT = (T - N × [SHBG - T + N]) / (K_T × SHBG)
where N = K_T × T + K_SHBG × SHBG + 1
      K_T = 1 × 10? L/mol (T-albumin association)
      K_SHBG = 5.97 × 10? L/mol (T-SHBG association)

Free Testosterone Thresholds:
- Normal: > 9 ng/dL (calculated) or > 6.5 ng/dL (direct)
- Low: < 5 ng/dL generally indicates hypogonadism
```

**Etiologic Workup**
```
LH/FSH Interpretation:
- Low T + Low/Normal LH: Secondary (central) hypogonadism
  ? Check prolactin, iron studies, pituitary MRI
- Low T + Elevated LH: Primary (testicular) hypogonadism
  ? Consider karyotype if indicated

Additional Testing:
- Prolactin: Rule out prolactinoma
- Estradiol: If gynecomastia present
- CBC: Baseline before TRT
- PSA: Baseline before TRT
- Metabolic panel: Baseline
```

#### ADAM Questionnaire (Androgen Deficiency in Aging Males)

**Screening Questions**
```
1. Do you have a decrease in libido (sex drive)?
2. Do you have a lack of energy?
3. Do you have a decrease in strength and/or endurance?
4. Have you lost height?
5. Have you noticed a decreased "enjoyment of life"?
6. Are you sad and/or grumpy?
7. Are your erections less strong?
8. Have you noted a recent deterioration in your ability to play sports?
9. Are you falling asleep after dinner?
10. Has there been a recent deterioration in your work performance?

Positive Screen: "Yes" to Question 1 or 7, OR "Yes" to any 3 questions
Sensitivity: 88%
Specificity: 60%
```

---

### Urolithiasis

#### STONE Score (Ureteral Stone Passage)

**Scoring Components**
```
S - Stone size:
- ? 2 mm: 0 points
- 3 mm: 1 point
- 4 mm: 2 points
- 5 mm: 3 points
- ? 6 mm: 4 points (unlikely to pass)

T - Tract length (ureter length from UVJ to stone):
- Distal ureter: 0 points
- Mid ureter: 1 point
- Proximal ureter: 2 points

O - Obstruction (hydronephrosis grade):
- None/Mild: 0 points
- Moderate: 1 point
- Severe: 2 points

N - Number of stones:
- Single: 0 points
- Multiple: 1 point

E - Erythrocytes (microscopic hematuria):
- Present: 0 points
- Absent: 1 point

Total Score: 0-10 points
```

**Passage Probability**
```
STONE Score | Passage Probability
    0-5     |      90-95%
    6-7     |      50-70%
    8-10    |      < 30%
```

#### Spontaneous Stone Passage Rates by Size and Location

**Evidence-Based Passage Rates**
```
Stone Size | Proximal | Mid    | Distal | Overall
< 2 mm     | 60%      | 70%    | 80%    | 75%
2-4 mm     | 50%      | 60%    | 75%    | 65%
4-5 mm     | 35%      | 45%    | 60%    | 50%
5-6 mm     | 20%      | 30%    | 45%    | 35%
6-7 mm     | 10%      | 15%    | 25%    | 20%
> 7 mm     | < 5%     | < 10%  | < 15%  | < 10%

Average Time to Passage:
- Distal: 1-2 weeks
- Mid: 2-3 weeks
- Proximal: 3-4+ weeks
```

#### 24-Hour Urine Interpretation

**Supersaturation Calculations**
```
Calcium Oxalate Supersaturation (CaOx SS):
- Normal: < 6.0
- Elevated: 6.0-10.0
- High risk: > 10.0

Calcium Phosphate Supersaturation (CaP SS):
- Normal: < 0.5
- Elevated: 0.5-2.0
- High risk: > 2.0

Uric Acid Supersaturation (UA SS):
- Normal: < 1.0
- Elevated: 1.0-2.0
- High risk: > 2.0
```

**Key Parameters and Treatment Targets**
```
Parameter          | Target         | Intervention
Urine volume       | > 2.5 L/day    | Fluid intake
Urine calcium      | < 200 mg/day   | Thiazide, low Na diet
Urine oxalate      | < 40 mg/day    | Low oxalate diet, calcium
Urine citrate      | > 450 mg/day   | K-citrate supplementation
Urine uric acid    | < 700 mg/day   | Low purine diet, allopurinol
Urine sodium       | < 150 mEq/day  | Low sodium diet
Urine pH           | 6.0-6.5        | K-citrate (low pH)
                   |                | Reduce alkali (high pH)
Urine cystine      | < 200 mg/day   | Hydration, alkalinization
```

#### Stone Composition and Prevention Strategies

**Composition-Specific Recommendations**
```
Stone Type      | % of Stones | Key Findings           | Prevention
Calcium Oxalate | 70-80%      | Hypercalciuria,        | Thiazide, citrate,
                |             | hyperoxaluria,         | moderate Ca intake
                |             | hypocitraturia         |
Calcium Phosphate| 10-15%     | High urine pH,         | Limit alkali,
(Apatite)       |             | hypercalciuria, RTA    | thiazide
Uric Acid       | 5-10%       | Low urine pH,          | K-citrate to pH 6.5,
                |             | hyperuricosuria        | allopurinol
Struvite        | 5-10%       | UTI (urease+),         | Complete removal,
                |             | alkaline urine         | treat infection
Cystine         | 1-3%        | Cystinuria (genetic)   | Hydration, D-pen,
                |             |                        | tiopronin, pH > 7.0
```

---

### Surgical Planning

#### Clinical Frailty Scale

**9-Point Scale**
```
1 - Very Fit: Robust, active, energetic, motivated, exercise regularly
2 - Fit: No active disease, less fit than category 1
3 - Managing Well: Medical problems well controlled, not regularly active
4 - Living with Very Mild Frailty: Previously "vulnerable", slowed, 
    symptoms limit activities
5 - Living with Mild Frailty: More evident slowing, needs help with IADLs
6 - Living with Moderate Frailty: Needs help with all outside activities, 
    keeping house
7 - Living with Severe Frailty: Completely dependent for personal care
8 - Very Severely Frail: Approaching end of life, could not recover 
    from minor illness
9 - Terminally Ill: Life expectancy < 6 months

Surgical Risk Interpretation:
CFS 1-3: Standard surgical candidate
CFS 4-5: Consider modified approach, enhanced recovery
CFS 6-7: High surgical risk, consider alternatives
CFS 8-9: Typically not surgical candidates
```

#### Revised Cardiac Risk Index (RCRI)

**Risk Factors (1 point each)**
```
1. High-risk surgery (intraperitoneal, intrathoracic, suprainguinal vascular)
2. History of ischemic heart disease
3. History of congestive heart failure
4. History of cerebrovascular disease
5. Diabetes requiring insulin therapy
6. Preoperative creatinine > 2.0 mg/dL
```

**Major Cardiac Event Risk**
```
RCRI Score | Risk of MACE
    0      |    0.4%
    1      |    0.9%
    2      |    6.6%
   ? 3     |   11.0%
```

#### ACS NSQIP Surgical Risk Calculator

**Input Variables**
```
Demographics:
- Age
- Sex
- Functional status (independent, partially dependent, totally dependent)
- Emergency case (yes/no)
- ASA class (1-5)

Comorbidities:
- Diabetes (none, oral, insulin)
- Smoking within 1 year
- COPD
- CHF within 30 days
- Hypertension requiring medication
- Dialysis
- Acute renal failure
- Disseminated cancer
- Steroid use for chronic condition
- > 10% weight loss in 6 months
- Bleeding disorder
- Transfusion > 4 units in 72 hours

Lab Values:
- Creatinine
- Albumin
- Bilirubin
- Hematocrit
- Platelet count
- INR
- WBC

Procedure:
- CPT code specific to planned operation
```

**Predicted Outcomes**
```
- 30-day mortality
- Any complication
- Serious complication
- Pneumonia
- Cardiac complication
- SSI
- UTI
- VTE
- Renal failure
- Discharge to nursing/rehab
```

#### Actuarial Life Expectancy (SSA Tables)

**Calculation Method**
```
Base life expectancy from SSA period life tables by age and sex

Comorbidity Adjustments (years subtracted):
- CHF: -3.5 years
- COPD (severe): -2.5 years
- Diabetes (uncontrolled): -2.0 years
- CKD Stage 4-5: -3.0 years
- Prior MI: -2.0 years
- Active malignancy: -5.0 years
- Dementia: -4.0 years

Adjusted LE = Base LE - ?(comorbidity adjustments)

10-Year Survival Probability:
If adjusted LE > 10: ~90% (scaled by LE)
If adjusted LE 5-10: ~50-80%
If adjusted LE < 5: < 50%
```

---

## User Interface Design

### Main Application Layout

```
???????????????????????????????????????????????????????????????????????????????
?  VA UROLOGY CLINICAL DOCUMENTATION ASSISTANT                    [User] [?]  ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  ???????????????????  ???????????????????  ???????????????????             ?
?  ? NOTE GENERATION ?  ?    SETTINGS     ?  ?  OPEN EVIDENCE  ?             ?
?  ?     [ACTIVE]    ?  ?                 ?  ?                 ?             ?
?  ???????????????????  ???????????????????  ???????????????????             ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
```

### Note Generation Screen

```
???????????????????????????????????????????????????????????????????????????????
?  NOTE GENERATION                                                            ?
???????????????????????????????????????????????????????????????????????????????
?                                   ?  CLINICAL MODULES                       ?
?  NOTE TYPE:                       ?  ?????????????????????????????????????  ?
?  ???????????????????????????????  ?                                         ?
?  ? ? Urology Clinic Note       ?  ?  ? PROSTATE CANCER                     ?
?  ? ? Urology Consult           ?  ?    ? PSA Tracking Table                ?
?  ? ? Urology Preop Note        ?  ?    ? PSA Kinetics (PSAV/PSADT)         ?
?  ? ? Urology Postop Note       ?  ?    ? PCPT Risk Calculator              ?
?  ???????????????????????????????  ?    ? CAPRA Score                       ?
?                                   ?    ? NCCN Risk Stratification          ?
?  CLINICAL INPUT:                  ?    ? NCCN Diagnostic Workup            ?
?  ???????????????????????????????  ?    ? NCCN Surveillance Schedule        ?
?  ?                             ?  ?                                         ?
?  ?  Paste clinical data here   ?  ?  ? KIDNEY CANCER                       ?
?  ?  (labs, imaging, notes)     ?  ?    ? RENAL Nephrometry Score           ?
?  ?                             ?  ?    ? SSIGN Score                       ?
?  ?                             ?  ?    ? IMDC Risk Criteria                ?
?  ?                             ?  ?    ? 5/10-Year Survival Estimate       ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? BLADDER CANCER                      ?
?  ?                             ?  ?    ? EORTC Recurrence Score            ?
?  ?                             ?  ?    ? EORTC Progression Score           ?
?  ?                             ?  ?    ? 5/10-Year Survival Estimate       ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? MALE VOIDING DYSFUNCTION            ?
?  ?                             ?  ?    ? IPSS Calculator                   ?
?  ?                             ?  ?    ? AUA Symptom Subscore Analysis     ?
?  ?                             ?  ?    ? BOOI/BCI (Urodynamics)            ?
?  ?                             ?  ?    ? Uroflowmetry Interpretation       ?
?  ?                             ?  ?    ? Post-Void Residual Assessment     ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? FEMALE UROLOGY                      ?
?  ?                             ?  ?    ? UDI-6 / IIQ-7 Scores              ?
?  ?                             ?  ?    ? OAB-q Assessment                  ?
?  ?                             ?  ?    ? POP-Q Staging                     ?
?  ?                             ?  ?    ? SUI Severity (Stamey/Sandvik)     ?
?  ?                             ?  ?    ? Bladder Diary Analysis            ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? RECONSTRUCTIVE UROLOGY              ?
?  ?                             ?  ?    ? Stricture Complexity Score        ?
?  ?                             ?  ?    ? PFUI Classification               ?
?  ?                             ?  ?    ? Fistula Classification            ?
?  ?                             ?  ?    ? Peyronie's Assessment             ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? MALE FERTILITY                      ?
?  ?                             ?  ?    ? Semen Analysis Interpretation     ?
?  ?                             ?  ?    ? Hormonal Evaluation Panel         ?
?  ?                             ?  ?    ? Varicocele Grading                ?
?  ?                             ?  ?    ? Azoospermia Classification        ?
?  ?                             ?  ?    ? Sperm DNA Fragmentation           ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? HYPOGONADISM                        ?
?  ?                             ?  ?    ? Testosterone Evaluation           ?
?  ?                             ?  ?    ? ADAM Questionnaire                ?
?  ?                             ?  ?    ? Treatment Monitoring Panel        ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? UROLITHIASIS                        ?
?  ?                             ?  ?    ? STONE Score                       ?
?  ?                             ?  ?    ? Passage Probability Calculator    ?
?  ?                             ?  ?    ? 24-Hour Urine Analysis            ?
?  ?                             ?  ?    ? Stone Prevention Plan             ?
?  ?                             ?  ?                                         ?
?  ?                             ?  ?  ? SURGICAL PLANNING                   ?
?  ?                             ?  ?    ? Clinical Frailty Scale            ?
?  ?                             ?  ?    ? RCRI Cardiac Risk                 ?
?  ?                             ?  ?    ? ACS NSQIP Risk Calculator         ?
?  ???????????????????????????????  ?    ? 10/15-Year Life Expectancy        ?
?                                   ?                                         ?
?  ???????????????????????????????  ???????????????????????????????????????????
?  ?     GENERATE NOTE           ?  ?  MODULE DATA INPUT                      ?
?  ???????????????????????????????  ?  [Dynamic form based on selections]     ?
?                                   ?                                         ?
???????????????????????????????????????????????????????????????????????????????
```

### Module Data Input Panel Examples

#### Example: Female Urology - POP-Q Assessment

```
???????????????????????????????????????????????????????????????????????????????
?  POP-Q ASSESSMENT                                               [Auto-fill] ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  ANTERIOR WALL                        POSTERIOR WALL                        ?
?  Aa: ?????????? cm (-3 to +3)         Ap: ?????????? cm (-3 to +3)         ?
?      ?   -1   ?                           ?   -2   ?                        ?
?      ??????????                           ??????????                        ?
?  Ba: ?????????? cm (-3 to +tvl)       Bp: ?????????? cm (-3 to +tvl)       ?
?      ?   -1   ?                           ?   -3   ?                        ?
?      ??????????                           ??????????                        ?
?                                                                             ?
?  APICAL                               REFERENCE MEASUREMENTS                ?
?  C:  ?????????? cm                    gh: ?????????? cm (genital hiatus)   ?
?      ?   -5   ?                           ?   3.5  ?                        ?
?      ??????????                           ??????????                        ?
?  D:  ?????????? cm (omit if post-hyst) pb: ?????????? cm (perineal body)  ?
?      ?   -7   ?                           ?   3.0  ?                        ?
?      ??????????                           ??????????                        ?
?                              tvl: ?????????? cm (total vaginal length)      ?
?                                   ?   9.0  ?                                ?
?                                   ??????????                                ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                                                             ?
?  CALCULATED POP-Q STAGE:                                                    ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?  Stage II Anterior Prolapse (Cystocele)                             ?   ?
?  ?  Leading edge (Ba) at -1 cm, within 1 cm of hymen                   ?   ?
?  ?                                                                      ?   ?
?  ?  POP-Q Grid:                                                         ?   ?
?  ?  ??????????????????????                                             ?   ?
?  ?  ? Aa   ? Ba   ?  C   ?                                             ?   ?
?  ?  ? -1   ? -1   ? -5   ?                                             ?   ?
?  ?  ??????????????????????                                             ?   ?
?  ?  ? gh   ? pb   ? tvl  ?                                             ?   ?
?  ?  ? 3.5  ? 3.0  ? 9.0  ?                                             ?   ?
?  ?  ??????????????????????                                             ?   ?
?  ?  ? Ap   ? Bp   ?  D   ?                                             ?   ?
?  ?  ? -2   ? -3   ? -7   ?                                             ?   ?
?  ?  ??????????????????????                                             ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
```

#### Example: Male Fertility - Semen Analysis

```
???????????????????????????????????????????????????????????????????????????????
?  SEMEN ANALYSIS INTERPRETATION                                  [Auto-fill] ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  COLLECTION DETAILS                                                         ?
?  Abstinence period: ?????????? days (2-7 recommended)                      ?
?                     ?   3    ?                                              ?
?                     ??????????                                              ?
?  Collection method: ? Masturbation  ? Post-coital  ? Other                 ?
?                                                                             ?
?  SEMEN PARAMETERS                                                           ?
?                           Value          Reference      Status              ?
?  Volume:             ???????????? mL     ? 1.4 mL      [? Normal]          ?
?                      ?   2.5    ?                                           ?
?                      ????????????                                           ?
?  Concentration:      ???????????? M/mL   ? 16 M/mL    [? Normal]          ?
?                      ?   8.0    ?                      [? LOW]              ?
?                      ????????????                                           ?
?  Total count:        ???????????? M      ? 39 M       [Auto-calc]          ?
?                      ?   20     ?                      [? LOW]              ?
?                      ????????????                                           ?
?  Total motility:     ???????????? %      ? 42%        [? Normal]          ?
?                      ?   55     ?                                           ?
?                      ????????????                                           ?
?  Progressive:        ???????????? %      ? 30%        [? Normal]          ?
?                      ?   38     ?                                           ?
?                      ????????????                                           ?
?  Morphology:         ???????????? %      ? 4%         [? Normal]          ?
?                      ?   5      ?                                           ?
?                      ????????????                                           ?
?  pH:                 ????????????        ? 7.2        [? Normal]          ?
?                      ?   7.4    ?                                           ?
?                      ????????????                                           ?
?                                                                             ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                                                             ?
?  INTERPRETATION:                                                            ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?  Diagnosis: OLIGOZOOSPERMIA (Mild)                                   ?   ?
?  ?                                                                      ?   ?
?  ?  Sperm concentration 8.0 M/mL is below WHO 2021 reference limit     ?   ?
?  ?  of 16 M/mL. Total sperm count 20 M is below reference of 39 M.     ?   ?
?  ?                                                                      ?   ?
?  ?  Motility and morphology parameters are within normal limits.        ?   ?
?  ?                                                                      ?   ?
?  ?  Recommended Evaluation:                                             ?   ?
?  ?  • Repeat semen analysis in 2-4 weeks                               ?   ?
?  ?  • Hormonal evaluation (FSH, LH, testosterone, prolactin)           ?   ?
?  ?  • Scrotal ultrasound to evaluate for varicocele                    ?   ?
?  ?  • Consider genetic testing if persistent oligospermia              ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
```

#### Example: Reconstructive - Stricture Assessment

```
???????????????????????????????????????????????????????????????????????????????
?  URETHRAL STRICTURE ASSESSMENT                                  [Auto-fill] ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  STRICTURE CHARACTERISTICS                                                  ?
?                                                                             ?
?  Location:           ??????????????????????????????????????????            ?
?                      ? Bulbar urethra - mid               ? ?            ?
?                      ??????????????????????????????????????????            ?
?                                                                             ?
?  Length:             ???????????? cm                                       ?
?                      ?   2.5    ?                                           ?
?                      ????????????                                           ?
?                                                                             ?
?  Etiology:           ??????????????????????????????????????????            ?
?                      ? Iatrogenic (catheter/instrumentation)? ?            ?
?                      ??????????????????????????????????????????            ?
?                                                                             ?
?  Prior Treatments:   ? None                                                ?
?                      ? DVIU/Dilation (number: ????? )                      ?
?                      ? Prior urethroplasty     ? 2 ?                        ?
?                      ? Multiple failed repairs ?????                        ?
?                                                                             ?
?  Associated Findings:                                                       ?
?                      ? Lichen sclerosus/BXO                                ?
?                      ? Fistula                                              ?
?                      ? False passage                                        ?
?                      ? Periurethral abscess history                        ?
?                                                                             ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                                                             ?
?  STRICTURE COMPLEXITY SCORE:                                                ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?  Location (Bulbar):                    1 point                       ?   ?
?  ?  Length (2-4 cm):                      2 points                      ?   ?
?  ?  Etiology (Iatrogenic):                1 point                       ?   ?
?  ?  Prior Treatment (DVIU/Dilation):      1 point                       ?   ?
?  ?  ??????????????????????????????????????????????                      ?   ?
?  ?  TOTAL:                                5 points (Low Complexity)     ?   ?
?  ?                                                                      ?   ?
?  ?  Surgical Recommendation:                                            ?   ?
?  ?  Primary excision and anastomotic urethroplasty likely feasible     ?   ?
?  ?  given mid-bulbar location and moderate length. Success rate        ?   ?
?  ?  expected > 90% for first-time repair.                               ?   ?
?  ?                                                                      ?   ?
?  ?  Note: Prior DVIU × 2 increases recurrence risk. Definitive         ?   ?
?  ?  urethroplasty recommended over repeat endoscopic treatment.         ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
```

### Settings Screen - Modules Tab (Updated)

```
???????????????????????????????????????????????????????????????????????????????
?  SETTINGS                                                                   ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  ??????????????? ??????????????? ??????????????? ???????????????           ?
?  ?  TEMPLATES  ? ?     LLM     ? ? KNOWLEDGE   ? ?  MODULES    ?           ?
?  ?             ? ?             ? ?    BASE     ? ?  [ACTIVE]   ?           ?
?  ??????????????? ??????????????? ??????????????? ???????????????           ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  MODULE DEFAULTS                                                            ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                                                             ?
?  PROSTATE CANCER                                                            ?
?  Default Calculator:   ??????????????????????????????????????????          ?
?                        ? CAPRA Score                          ? ?          ?
?                        ??????????????????????????????????????????          ?
?  ? Include NCCN Risk Stratification by default                             ?
?  ? Auto-calculate PSA kinetics when multiple values available              ?
?                                                                             ?
?  KIDNEY CANCER                                                              ?
?  Default Nephrometry:  ??????????????????????????????????????????          ?
?                        ? RENAL Score                          ? ?          ?
?                        ??????????????????????????????????????????          ?
?  Survival Model:       ??????????????????????????????????????????          ?
?                        ? SSIGN Score                          ? ?          ?
?                        ??????????????????????????????????????????          ?
?                                                                             ?
?  BLADDER CANCER                                                             ?
?  NMIBC Model:          ??????????????????????????????????????????          ?
?                        ? EORTC Risk Tables                    ? ?          ?
?                        ??????????????????????????????????????????          ?
?                                                                             ?
?  MALE VOIDING DYSFUNCTION                                                   ?
?  ? Calculate storage/voiding subscores automatically                       ?
?  ? Include PVR interpretation with IPSS                                    ?
?  Flow interpretation:  ??????????????????????????????????????????          ?
?                        ? Liverpool Nomogram                   ? ?          ?
?                        ??????????????????????????????????????????          ?
?                                                                             ?
?  FEMALE UROLOGY                                                             ?
?  Default UI measure:   ??????????????????????????????????????????          ?
?                        ? UDI-6 / IIQ-7                        ? ?          ?
?                        ??????????????????????????????????????????          ?
?  SUI Severity Scale:   ??????????????????????????????????????????          ?
?                        ? Sandvik Severity Index               ? ?          ?
?                        ??????????????????????????????????????????          ?
?  ? Auto-generate POP-Q grid diagram                                        ?
?                                                                             ?
?  RECONSTRUCTIVE UROLOGY                                                     ?
?  Stricture scoring:    ??????????????????????????????????????????          ?
?                        ? Complexity Score                     ? ?          ?
?                        ??????????????????????????????????????????          ?
?  ? Include surgical recommendation with stricture assessment               ?
?                                                                             ?
?  MALE FERTILITY                                                             ?
?  SA Reference:         ??????????????????????????????????????????          ?
?                        ? WHO 2021 (6th Edition)               ? ?          ?
?                        ??????????????????????????????????????????          ?
?  ? Auto-calculate total sperm count                                        ?
?  ? Generate differential diagnosis for abnormal findings                   ?
?  ? Include recommended workup steps                                        ?
?                                                                             ?
?  SURGICAL PLANNING                                                          ?
?  Frailty Scale:        ??????????????????????????????????????????          ?
?                        ? Clinical Frailty Scale               ? ?          ?
?                        ??????????????????????????????????????????          ?
?  Life Table Source:    ??????????????????????????????????????????          ?
?                        ? SSA Period Life Tables 2023          ? ?          ?
?                        ??????????????????????????????????????????          ?
?  ? Apply comorbidity adjustments to life expectancy                        ?
?                                                                             ?
?  DISPLAY PREFERENCES                                                        ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                                                             ?
?  ? Show confidence intervals on survival estimates                         ?
?  ? Include guideline citations in output                                   ?
?  ? Display detailed calculation breakdown                                  ?
?  ? Highlight values outside normal ranges                                  ?
?  ? Generate visual diagrams where applicable                               ?
?                                                                             ?
?  [Save Module Settings]  [Reset to Defaults]                               ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
```

### Generated Note Output with Multiple Modules

```
???????????????????????????????????????????????????????????????????????????????
?  GENERATED NOTE                                    [Copy] [Export] [Edit]   ?
???????????????????????????????????????????????????????????????????????????????
?                                                                             ?
?  UROLOGY CONSULT NOTE                                                       ?
?  Date: [Current Date]                                                       ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                                                             ?
?  REASON FOR CONSULTATION:                                                   ?
?  Infertility evaluation, abnormal semen analysis                           ?
?                                                                             ?
?  HISTORY OF PRESENT ILLNESS:                                                ?
?  32-year-old male referred for primary infertility. Couple attempting      ?
?  conception for 18 months without success. Female partner evaluation       ?
?  normal per OB/GYN. Patient reports normal libido, erections, and          ?
?  ejaculation. No history of cryptorchidism, testicular trauma, or          ?
?  prior genital surgery. Denies tobacco, alcohol, or illicit drug use.      ?
?  No occupational heat exposure or gonadotoxin exposure.                    ?
?                                                                             ?
?  [... continued structured note content ...]                                ?
?                                                                             ?
?  PHYSICAL EXAMINATION:                                                      ?
?  - Testes: Right 18 mL, Left 15 mL (Grade II varicocele on left)          ?
?  - Vas deferens: Bilaterally palpable                                      ?
?  - Penis: Normal, no Peyronie's plaque                                     ?
?  - DRE: Prostate normal size, no nodules                                   ?
?                                                                             ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?  CLINICAL DECISION SUPPORT APPENDIX                                         ?
?  ?????????????????????????????????????????????????????????????????????????  ?
?                                                                             ?
?  SEMEN ANALYSIS INTERPRETATION (WHO 2021):                                  ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?  Parameter        ? Result    ? Reference ? Status                  ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?  Volume           ? 2.5 mL    ? ? 1.4 mL  ? Normal                  ?   ?
?  ?  Concentration    ? 8 M/mL    ? ? 16 M/mL ? LOW - Oligozoospermia   ?   ?
?  ?  Total count      ? 20 M      ? ? 39 M    ? LOW                     ?   ?
?  ?  Total motility   ? 55%       ? ? 42%     ? Normal                  ?   ?
?  ?  Progressive      ? 38%       ? ? 30%     ? Normal                  ?   ?
?  ?  Morphology       ? 5%        ? ? 4%      ? Normal                  ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  Diagnosis: Mild Oligozoospermia                                           ?
?                                                                             ?
?  HORMONAL PANEL:                                                            ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?  Test             ? Result    ? Reference ? Interpretation          ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?  Total T (AM)     ? 485 ng/dL ? 300-1000  ? Normal                  ?   ?
?  ?  FSH              ? 6.2 mIU/mL? 1.5-12.4  ? Normal                  ?   ?
?  ?  LH               ? 4.8 mIU/mL? 1.7-8.6   ? Normal                  ?   ?
?  ?  Prolactin        ? 8 ng/mL   ? 4-15      ? Normal                  ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  Pattern: Normal hormonal axis, suggests non-endocrine etiology            ?
?                                                                             ?
?  VARICOCELE ASSESSMENT:                                                     ?
?  Grade: II (palpable at rest, not visible)                                 ?
?  Laterality: Left                                                           ?
?  Testicular asymmetry: 17% (Left smaller) - within acceptable range        ?
?                                                                             ?
?  Surgical Indication Score: 4 points                                        ?
?  - Palpable varicocele: Required criterion met                             ?
?  - Abnormal semen analysis: +2 points                                      ?
?  - Female partner < 35, normal evaluation: +1 point                        ?
?  - No significant testicular hypotrophy: +0 points                         ?
?  - Partner factor: +1 point                                                ?
?                                                                             ?
?  Recommendation: Varicocelectomy indicated - Score ? 3                     ?
?                                                                             ?
?  ASSESSMENT AND PLAN:                                                       ?
?  1. Mild oligozoospermia with Grade II left varicocele                     ?
?  2. Recommend microsurgical varicocelectomy                                ?
?  3. Repeat semen analysis 3 months post-procedure                          ?
?  4. Genetic counseling offered given oligospermia                          ?
?                                                                             ?
???????????????????????????????????????????????????????????????????????????????
```

---

## Technical Architecture

### Component Architecture

```
???????????????????????????????????????????????????????????????????????????????
?                              PRESENTATION LAYER                             ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?                    Web Interface (HTML/CSS/JS)                       ?   ?
?  ?              React or HTMX + Tailwind CSS + Alpine.js                ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
???????????????????????????????????????????????????????????????????????????????
?                              APPLICATION LAYER                              ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
?  ?  FastAPI      ?  ?  Note         ?  ?  Clinical Module Engine       ?   ?
?  ?  Backend      ?  ?  Generator    ?  ?  (Calculator Orchestration)   ?   ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
?  ?  Template     ?  ?  Settings     ?  ?  Document Processor           ?   ?
?  ?  Manager      ?  ?  Manager      ?  ?  (PDF/DOCX Ingestion)         ?   ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
???????????????????????????????????????????????????????????????????????????????
?                           CLINICAL MODULE LAYER                             ?
?  ??????????????? ??????????????? ??????????????? ???????????????           ?
?  ?  Prostate   ? ?   Kidney    ? ?   Bladder   ? ?    Male     ?           ?
?  ?  Cancer     ? ?   Cancer    ? ?   Cancer    ? ?   Voiding   ?           ?
?  ??????????????? ??????????????? ??????????????? ???????????????           ?
?  ??????????????? ??????????????? ??????????????? ???????????????           ?
?  ?   Female    ? ?  Reconstr.  ? ?    Male     ? ?   Stones    ?           ?
?  ?   Urology   ? ?   Urology   ? ?  Fertility  ? ?             ?           ?
?  ??????????????? ??????????????? ??????????????? ???????????????           ?
?  ??????????????? ???????????????                                           ?
?  ? Hypogonadism? ?  Surgical   ?                                           ?
?  ?             ? ?  Planning   ?                                           ?
?  ??????????????? ???????????????                                           ?
???????????????????????????????????????????????????????????????????????????????
?                                 LLM LAYER                                   ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
?  ?  Ollama       ?  ?  Anthropic    ?  ?  OpenAI                       ?   ?
?  ?  Client       ?  ?  Client       ?  ?  Client                       ?   ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
?  ???????????????????????????????????????????????????????????????????????   ?
?  ?                    RAG Pipeline (LangChain)                          ?   ?
?  ???????????????????????????????????????????????????????????????????????   ?
???????????????????????????????????????????????????????????????????????????????
?                                 DATA LAYER                                  ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
?  ?  Neo4j        ?  ?  SQLite       ?  ?  File Storage                 ?   ?
?  ?  Vector + KG  ?  ?  Settings DB  ?  ?  (Documents, Templates)       ?   ?
?  ?????????????????  ?????????????????  ?????????????????????????????????   ?
???????????????????????????????????????????????????????????????????????????????
```

---

## Module Summary

| Category | Modules | Key Calculators/Assessments |
|----------|---------|----------------------------|
| Prostate Cancer | 7 | PSA Kinetics, PCPT, CAPRA, NCCN Risk |
| Kidney Cancer | 4 | RENAL, SSIGN, IMDC, Survival |
| Bladder Cancer | 3 | EORTC Recurrence/Progression, Survival |
| Male Voiding | 5 | IPSS, BOOI/BCI, Uroflow, PVR |
| Female Urology | 5 | UDI-6/IIQ-7, OAB-q, POP-Q, SUI Severity |
| Reconstructive | 4 | Stricture Complexity, PFUI, Fistula, Peyronie's |
| Male Fertility | 5 | Semen Analysis, Hormones, Varicocele, Azoospermia |
| Hypogonadism | 3 | Testosterone Eval, ADAM, Monitoring |
| Urolithiasis | 4 | STONE Score, Passage Rates, 24-hr Urine |
| Surgical Planning | 4 | CFS, RCRI, NSQIP, Life Expectancy |

**Total: 44 Clinical Modules**

-