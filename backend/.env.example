# ==================================================================================
# VAUCDA Backend Production Environment Template
# ==================================================================================
#
# IMPORTANT: This is a template file
# For actual deployment:
# 1. Copy to .env: cp .env.example .env
# 2. Replace all CHANGE_THIS values with secure secrets
# 3. Set permissions: chmod 600 .env
#
# ==================================================================================

# Application Configuration
APP_NAME=VAUCDA
APP_VERSION=1.0.0
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# Server Configuration
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4

# ==================================================================================
# DATABASE - Neo4j (Graph Database)
# ==================================================================================
NEO4J_URI=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=CHANGE_THIS_TO_SECURE_PASSWORD
NEO4J_DATABASE=neo4j
NEO4J_MAX_CONNECTION_POOL_SIZE=100
NEO4J_CONNECTION_TIMEOUT=60

# Neo4j Vector Search Configuration
NEO4J_VECTOR_DIMENSIONS=768
NEO4J_SIMILARITY_FUNCTION=cosine

# ==================================================================================
# DATABASE - SQLite (Settings Database)
# ==================================================================================
SQLITE_DATABASE_URL=sqlite+aiosqlite:////app/data/vaucda.db
SQLITE_ECHO=false

# ==================================================================================
# DATABASE - Redis (Cache & Message Broker)
# ==================================================================================
REDIS_URL=redis://:CHANGE_THIS_TO_SECURE_PASSWORD@redis:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_DECODE_RESPONSES=true

# ==================================================================================
# SECURITY - JWT (JSON Web Tokens)
# ==================================================================================
JWT_SECRET_KEY=CHANGE_THIS_TO_SECURE_RANDOM_STRING_32_CHARS
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# ==================================================================================
# SECURITY - PASSWORD HASHING
# ==================================================================================
PASSWORD_HASH_ALGORITHM=bcrypt
PASSWORD_HASH_ROUNDS=12

# ==================================================================================
# SECURITY - CORS
# ==================================================================================
CORS_ORIGINS=["http://localhost:3000","https://vaucda.va.gov"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET","POST","PUT","DELETE","OPTIONS"]
CORS_ALLOW_HEADERS=["*"]

# ==================================================================================
# LLM - Ollama (Primary Provider)
# ==================================================================================
OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_DEFAULT_MODEL=llama3.1:8b
OLLAMA_TIMEOUT=120
OLLAMA_EMBEDDING_MODEL=nomic-embed-text

# Task-specific models
OLLAMA_NOTE_GENERATION_MODEL=llama3.1:70b
OLLAMA_CLINICAL_EXTRACTION_MODEL=llama3.1:8b
OLLAMA_CALCULATOR_ASSIST_MODEL=phi3:medium
OLLAMA_EVIDENCE_SEARCH_MODEL=llama3.1:8b

# ==================================================================================
# LLM - Anthropic Claude (Optional)
# ==================================================================================
ANTHROPIC_ENABLED=false
ANTHROPIC_API_KEY=
ANTHROPIC_DEFAULT_MODEL=claude-3-5-sonnet-20250101
ANTHROPIC_MAX_TOKENS=8096
ANTHROPIC_TIMEOUT=60

# ==================================================================================
# LLM - OpenAI GPT (Optional)
# ==================================================================================
OPENAI_ENABLED=false
OPENAI_API_KEY=
OPENAI_DEFAULT_MODEL=gpt-4o
OPENAI_MAX_TOKENS=8096
OPENAI_TIMEOUT=60

# ==================================================================================
# LLM - Generation Parameters
# ==================================================================================
LLM_TEMPERATURE=0.3
LLM_TOP_P=0.9
LLM_MAX_TOKENS=4096
LLM_FREQUENCY_PENALTY=0.0
LLM_PRESENCE_PENALTY=0.0

# ==================================================================================
# RAG (Retrieval Augmented Generation)
# ==================================================================================
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_DIMENSION=768
VECTOR_SEARCH_TOP_K=5
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
RAG_MIN_SIMILARITY=0.7
RAG_MAX_CONTEXT_LENGTH=8192

# ==================================================================================
# NOTE GENERATION
# ==================================================================================
NOTE_GENERATION_TIMEOUT=30
NOTE_SESSION_TTL_MINUTES=30
MAX_NOTE_LENGTH=10000

# ==================================================================================
# CELERY - Background Task Processing
# ==================================================================================
CELERY_BROKER_URL=redis://:CHANGE_THIS_TO_SECURE_PASSWORD@redis:6379/0
CELERY_RESULT_BACKEND=redis://:CHANGE_THIS_TO_SECURE_PASSWORD@redis:6379/1
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC
CELERY_WORKER_CONCURRENCY=4
CELERY_TASK_TIME_LIMIT=300
CELERY_TASK_SOFT_TIME_LIMIT=240

# ==================================================================================
# RATE LIMITING
# ==================================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_ANONYMOUS=10
RATE_LIMIT_AUTHENTICATED=100
RATE_LIMIT_ADMIN=1000

# ==================================================================================
# FILE UPLOAD
# ==================================================================================
MAX_UPLOAD_SIZE_MB=10
MAX_UPLOAD_SIZE=10485760
ALLOWED_DOCUMENT_TYPES=["pdf","docx","txt"]

# ==================================================================================
# DATA DIRECTORIES
# ==================================================================================
DATA_DIR=/app/data
DOCUMENTS_DIR=/app/data/documents
TEMPLATES_DIR=/app/data/templates
EXPORTS_DIR=/app/data/exports
LOGS_DIR=/app/logs

# ==================================================================================
# SESSION MANAGEMENT
# ==================================================================================
SESSION_CLEANUP_INTERVAL_MINUTES=5
AUDIT_LOG_RETENTION_DAYS=90
SESSION_TIMEOUT=1800

# ==================================================================================
# PHI (Protected Health Information) HANDLING
# ==================================================================================
EPHEMERAL_DATA_ENABLED=true
SECURE_MEMORY_WIPE=true
PHI_AUDIT_LOGGING=true
MAX_PHI_RETENTION_SECONDS=0

# ==================================================================================
# MONITORING
# ==================================================================================
ENABLE_PROMETHEUS=true
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# ==================================================================================
# OPENEVIDENCE INTEGRATION
# ==================================================================================
# Fernet encryption key for user credentials
# Generate: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
OPENEVIDENCE_ENCRYPTION_KEY=CHANGE_THIS_TO_FERNET_KEY

# ==================================================================================
# TEMPLATES
# ==================================================================================
DEFAULT_CLINIC_NOTE_TEMPLATE=urology_clinic_v1
DEFAULT_CONSULT_TEMPLATE=urology_consult_v1
DEFAULT_PREOP_TEMPLATE=urology_preop_v1
DEFAULT_POSTOP_TEMPLATE=urology_postop_v1
SYSTEM_PROMPT_FILE=/app/urology_prompt.txt

# ==================================================================================
# NOTIFICATIONS (Optional)
# ==================================================================================
EMAIL_ENABLED=false
EMAIL_SMTP_HOST=smtp.va.gov
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=
EMAIL_SMTP_PASSWORD=
EMAIL_FROM_ADDRESS=noreply@vaucda.va.gov
EMAIL_ADMIN_RECIPIENTS=admin@vaucda.va.gov

# ==================================================================================
# PERFORMANCE TUNING
# ==================================================================================
RESPONSE_CACHE_ENABLED=true
NOTE_CACHE_TTL=1800
CALCULATOR_RESULT_CACHE_TTL=3600
DB_POOL_SIZE=10
DB_POOL_TIMEOUT=30

# ==================================================================================
# FEATURE FLAGS
# ==================================================================================
EXPERIMENTAL_FEATURES_ENABLED=false
WEBSOCKET_STREAMING_ENABLED=true
BATCH_CALCULATOR_ENABLED=true
DOCUMENT_INGESTION_ENABLED=true

# ==================================================================================
# VA INTEGRATION (Future)
# ==================================================================================
VA_PIV_ENABLED=false
VA_NETWORK_ENABLED=false
